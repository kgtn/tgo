services:
  # RAG services (reuse same image, override build context when in source mode)
  tgo-rag-worker:
    build:
      context: ./repos/tgo-rag

  tgo-rag-beat:
    build:
      context: ./repos/tgo-rag

  tgo-rag-flower:
    build:
      context: ./repos/tgo-rag

  tgo-rag:
    build:
      context: ./repos/tgo-rag

  # AI service
  tgo-ai:
    build:
      context: ./repos/tgo-ai

  # API service
  tgo-api:
    build:
      context: ./repos/tgo-api

  # Platform service
  tgo-platform:
    build:
      context: ./repos/tgo-platform

  # Customer-facing web app
  tgo-web:
    build:
      context: ./repos/tgo-web
    args:
      VITE_WIDGET_PREVIEW_URL: ${VITE_WIDGET_PREVIEW_URL:-http://localhost:${WIDGET_PORT:-3001}}

  # Widget app
  tgo-widget-app:
    build:
      context: ./repos/tgo-widget-app
    args:
      VITE_API_BASE: ${VITE_API_BASE:-http://localhost:${API_PORT:-8000}}

